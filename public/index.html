<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Cache API Performance Test</title>
  <script type="importmap">
    {
      "imports": {
        "chart.js": "https://cdn.jsdelivr.net/npm/chart.js@4.4.1/+esm"
      }
    }
  </script>
  <style>
    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }

    body {
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
      max-width: 1200px;
      margin: 0 auto;
      padding: 20px;
      background: #f9fafb;
      color: #111827;
      line-height: 1.6;
    }

    h1 {
      font-size: 2rem;
      margin-bottom: 0.5rem;
      color: #1f2937;
    }

    .subtitle {
      color: #6b7280;
      margin-bottom: 2rem;
      font-size: 0.95rem;
    }

    .card {
      background: white;
      border-radius: 8px;
      padding: 20px;
      margin-bottom: 20px;
      box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
    }

    .controls {
      display: flex;
      align-items: center;
      gap: 15px;
      flex-wrap: wrap;
    }

    .controls label {
      display: flex;
      align-items: center;
      gap: 8px;
      font-weight: 500;
    }

    .controls input[type="number"] {
      padding: 8px 12px;
      border: 1px solid #d1d5db;
      border-radius: 6px;
      font-size: 1rem;
      width: 100px;
    }

    .controls input[type="number"]:focus {
      outline: none;
      border-color: #3b82f6;
      box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
    }

    button {
      padding: 10px 20px;
      border: none;
      border-radius: 6px;
      font-size: 1rem;
      font-weight: 500;
      cursor: pointer;
      transition: all 0.2s;
    }

    #start-test {
      background: #3b82f6;
      color: white;
    }

    #start-test:hover:not(:disabled) {
      background: #2563eb;
    }

    #start-test:disabled {
      background: #9ca3af;
      cursor: not-allowed;
    }

    #stop-test {
      background: #ef4444;
      color: white;
    }

    #stop-test:hover:not(:disabled) {
      background: #dc2626;
    }

    #stop-test:disabled {
      background: #9ca3af;
      cursor: not-allowed;
    }

    .progress-container {
      margin-top: 15px;
    }

    progress {
      width: 100%;
      height: 30px;
      border-radius: 6px;
      overflow: hidden;
    }

    progress::-webkit-progress-bar {
      background-color: #e5e7eb;
      border-radius: 6px;
    }

    progress::-webkit-progress-value {
      background: linear-gradient(90deg, #3b82f6, #2563eb);
      border-radius: 6px;
    }

    progress::-moz-progress-bar {
      background: linear-gradient(90deg, #3b82f6, #2563eb);
      border-radius: 6px;
    }

    #progress-text {
      display: block;
      margin-top: 8px;
      font-size: 0.9rem;
      color: #6b7280;
    }

    #storage-info {
      margin-top: 8px;
      padding: 8px 12px;
      background: #f3f4f6;
      border-radius: 6px;
      font-size: 0.85rem;
      color: #4b5563;
      font-family: 'Monaco', 'Menlo', monospace;
    }

    #chart-container {
      height: 400px;
      position: relative;
    }

    #summary {
      display: none;
    }

    #summary h2 {
      margin-bottom: 1rem;
      color: #1f2937;
    }

    #summary h3 {
      margin-bottom: 0.5rem;
      font-size: 1.1rem;
      color: #374151;
    }

    #summary p {
      margin: 0.3rem 0;
      color: #4b5563;
    }

    #summary strong {
      color: #1f2937;
    }

    .info-box {
      background: #eff6ff;
      border-left: 4px solid #3b82f6;
      padding: 15px;
      border-radius: 4px;
      font-size: 0.9rem;
      color: #1e40af;
      margin-bottom: 20px;
    }

    .info-box strong {
      display: block;
      margin-bottom: 5px;
    }

    @media (max-width: 768px) {
      body {
        padding: 15px;
      }

      h1 {
        font-size: 1.5rem;
      }

      .controls {
        flex-direction: column;
        align-items: stretch;
      }

      .controls label {
        flex-direction: column;
        align-items: flex-start;
      }

      .controls input[type="number"] {
        width: 100%;
      }
    }
  </style>
</head>
<body>
  <h1>Cache API Performance Test</h1>
  <p class="subtitle">Measure caches.open() and cache.match() performance at scale</p>

  <div class="info-box">
    <strong>What this test does:</strong>
    This tool incrementally adds large assets (5MB each) to the Cache API and measures how performance changes as the cache grows.
    It helps identify performance degradation patterns and potential bottlenecks at production-scale cache sizes.
  </div>

  <div class="card">
    <div class="controls">
      <label>
        Target Cache Size (GB):
        <input type="number" id="target-size" value="1" min="0.1" max="10" step="0.1">
      </label>
      <button id="start-test">Start Test</button>
      <button id="stop-test" disabled>Stop Test</button>
    </div>

    <div class="progress-container">
      <progress id="progress-bar" value="0" max="100"></progress>
      <span id="progress-text">Ready to start</span>
      <div id="storage-info">Storage info will appear here</div>
    </div>
  </div>

  <div class="card">
    <h2 style="margin-bottom: 15px; font-size: 1.3rem;">Performance Chart</h2>
    <div id="chart-container">
      <canvas id="performance-chart"></canvas>
    </div>
  </div>

  <div class="card" id="summary">
    <h2>Test Summary</h2>
    <div id="summary-content"></div>
  </div>

  <script type="module" src="/dist/main.js"></script>
</body>
</html>
